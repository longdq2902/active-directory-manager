@model ADPasswordManager.Models.Entities.DelegationRule

@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Confirm Deletion</title>
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>
<body class="bg-gray-50 p-6">

    @if (ViewBag.DeleteSuccess != true)
    {
        <h3 class="text-lg font-semibold text-gray-900">Are you sure you want to delete this rule?</h3>
        <hr class="my-4" />

        <div>
            <dl class="space-y-4">
                <div>
                    <dt class="text-sm font-medium text-gray-500">Admin Group</dt>
                    <dd class="mt-1 text-sm text-gray-900 font-semibold">@Html.DisplayFor(model => model.AdminGroup)</dd>
                </div>
                <div>
                    <dt class="text-sm font-medium text-gray-500">Managed Groups</dt>
                    <dd class="mt-1 text-sm text-gray-900">
                        <div class="flex flex-wrap gap-2">
                            @foreach (var group in Model.ManagedGroups.Split(',', StringSplitOptions.RemoveEmptyEntries))
                            {
                                <span class="px-2 py-1 bg-gray-200 text-gray-800 text-xs font-medium rounded-full">@group</span>
                            }
                        </div>
                    </dd>
                </div>
            </dl>
        </div>

        <form asp-action="Delete" class="mt-6">
            <input type="hidden" asp-for="Id" />
            <div class="flex justify-end gap-4">
                <button type="button" id="cancel-delete-btn" class="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50">
                    Cancel
                </button>
                <input type="submit" value="OK (Delete)" class="py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 cursor-pointer" />
            </div>
        </form>
    }

    <script>
        // Lắng nghe nút Cancel nếu nó tồn tại
        const cancelBtn = document.getElementById('cancel-delete-btn');
        if (cancelBtn) {
            cancelBtn.addEventListener('click', () => {
                window.parent.postMessage('closeRuleModal', '*');
            });
        }
    </script>

    @if (ViewBag.DeleteSuccess == true)
    {
        <script>
            // Nếu đã xóa thành công, gửi tín hiệu về cho cửa sổ cha
            window.parent.postMessage('ruleSaved', '*');
        </script>
    }
</body>
</html>